/*   
App Sorteo An√°huac
Version: 1.0
Website: http://www.redanahuac.mx/app/sorteo
*/

var pag = 1;

var Listar = function () {
	"use strict"; return {
		init: function () {

			handleListar();

		}
	}
}()


$(document).ready(function () {

	handleBuscarMetodosPago(function(){
		handleListar();
	});
});

function handleBuscarMetodosPago(f_success)
{
	$.ajax({
		type: 'GET',
		url: 'ConciliacionElectronica',
		data: 'view=BuscarMetodosPago',
		success: function (msg) {
			$("#metodo_pago").html(msg);
			if (f_success!=null && typeof(f_success)=='function')
				f_success();
		}
	});
}

function changeMetodo() {
	handleListar();
}

function onkeyup_colfield_check(e) {
	if (e.which == 13) {
		var search = $("#searchtable").val();
		if (search.trim() != "") { pag = 1; }
		handleListar()
	}
}

function changeShow() {
	getPag(1);
}

function getPag(page) {
	pag = page;
	handleListar()
}

function btnSearch(){
	getPag(1);
}

var handleListar = function () {

	var show = $("#data-elements-length").val();
	var search = $("#searchtable").val();

	var idsectorb = $("#idsectorb").val();
	var idnichob = $("#idnichob").val();
	var metodo_pago = $('#metodo_pago').val();

	$('div.block').block({
		css: { backgroundColor: 'transparent', color: '#336B86', border: "null" },
		overlayCSS: { backgroundColor: '#FFF' },
		message: '<img src="assets/img/load-search.gif" /><br><h2> Buscando ...</h2>'
	});

	$.ajax({
		type: "GET",
		url: "ConciliacionElectronica",
		data: "view=Buscar&pg=" + pag + "&show=" + show + "&search=" + search + "&idsectorb=" + idsectorb + "&idnichob=" + idnichob + "&metodo_pago=" + metodo_pago,
		success: function (msg) {
			$('div.block').unblock();
			$("#listresultados").html(msg);
		},
		error: function(msg) {
			$('div.block').unblock();
			$('#listresultados').html(__msg_sin_conexion);
		}
	});
}

//busca sectores al comienzo de cargar la pagina 

function Conciliacion_1() {
	location.href = "Conciliacion";
}

function Conciliacion_2() {
	//location.href = "ConciliacionElectronica";
}

function Conciliacion_3() {
	location.href = "ConciliacionFisica";
}


function ExportExcel() {

	var show = $("#data-elements-length").val();
	var search = $("#searchtable").val();

	var idsectorb = $("#idsectorb").val();
	var idnichob = $("#idnichob").val();

	if (search != "") { pag = 1; }


	location.href = "Conciliacion?view=ExportExcel&pg=" + pag + "&show=" + show + "&search=" + search + "&idsectorb=" + idsectorb + "&idnichob=" + idnichob;

}


